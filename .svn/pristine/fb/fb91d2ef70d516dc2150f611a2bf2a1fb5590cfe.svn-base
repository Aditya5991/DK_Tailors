package database.table;

import java.util.HashMap;

import database.table.customerBalance.DBTable_CustomerBalance;
import database.table.customerDetails.DBTable_CustomerDetails;
import database.table.customerMeasurements.DBTable_CustomerMeasurements;
import logger.Logger;

public class DB_TableManager
{

	private HashMap<String, DBTable> myTables;
	private static DB_TableManager myInstance = null;

	private DB_TableManager()
	{
	}

	public void Init()
	{
		myTables = new HashMap<String, DBTable>();
		AddTable(new DBTable_CustomerDetails(DB_TableNames.CUSTOMER_DETAILS));
		AddTable(new DBTable_CustomerMeasurements(DB_TableNames.CUSTOMER_MEASUREMENTS));
		AddTable(new DBTable_CustomerBalance(DB_TableNames.CUSTOMER_BALANCE));
	}

	public void AddTable(DBTable table)
	{
		if (!myTables.containsValue(table))
		{
			myTables.put(table.GetName(), table);
			return;
		}

		Logger.Log("Table " + table.GetName() + " already exists!");
	}

	public void DeleteTable(String name)
	{
		if (myTables.containsKey(name))
		{
			DBTable table = myTables.remove(name);
			table.DeleteTable();
			return;
		}

		Logger.Log("Unable to delete table: " + name + " (no table exists by this name!)");
	}

	public DBTable GetTable(String name)
	{
		if (myTables.containsKey(name))
			return myTables.get(name);

		assert false;
		return null;
	}

	public static DB_TableManager GetInstance()
	{
		if (myInstance == null)
			myInstance = new DB_TableManager();

		return myInstance;
	}

}
